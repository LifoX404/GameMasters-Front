<!-- Estado de carga -->
@if (loading) {
  <div class="flex justify-content-center align-items-center min-h-screen">
    <p-progressSpinner styleClass="w-4rem h-4rem"></p-progressSpinner>
    <p class="ml-3 text-lg font-medium">Cargando órdenes...</p>
  </div>
}

<!-- Estado de error -->
@if (error && !loading) {
  <p-card header="Error al cargar órdenes" class="m-4 shadow-3 border-round-md">
    <p class="text-red-600 mb-3">{{ error }}</p>
    <p-button 
      label="Reintentar" 
      icon="pi pi-refresh" 
      (click)="loadOrders()" 
      styleClass="p-button-warning">
    </p-button>
  </p-card>
}

<!-- Tabla de órdenes -->
@if (!loading && !error) {
  <p-card header="Órdenes" class="m-4 shadow-3 border-round-md">
    <p-table 
      [value]="ordenes" 
      dataKey="id"
      responsiveLayout="scroll" 
      class="shadow-2 border-round-md">
      
      <ng-template pTemplate="header">
        <tr>
          <th>Fecha</th>
          <th>Total</th>
          <th>Método de Pago</th>
          <th>Estado</th>
          <th>Acciones</th>
        </tr>
      </ng-template>

      <ng-template pTemplate="body" let-item>
        <tr>
          <td>{{ item.orderDate | date: 'dd/MM/yyyy' }}</td>
          <td>S/ {{ item.orderTotal | number: '1.2-2' }}</td>
          <td>{{ item.paymentMethod }}</td>
          <td>
            <p-tag 
              [value]="item.orderStatus"
              [severity]="getSeverity(item.orderStatus)">
            </p-tag>
          </td>
          <td>
            <div class="flex gap-2">
              <p-button 
                label="Detalles" 
                icon="pi pi-eye" 
                [routerLink]="['/admin/ordenes', item.id]"
                styleClass="p-button-info p-button-sm">
              </p-button>

              <p-button 
                label="Editar" 
                icon="pi pi-pencil" 
                [routerLink]="['/ordenes', item.id, 'editar']"
                styleClass="p-button-secondary p-button-sm">
              </p-button>
            </div>
          </td>
        </tr>
      </ng-template>

      <ng-template pTemplate="emptymessage">
        <tr>
          <td colspan="5" class="text-center py-4 text-gray-500">
            No hay órdenes disponibles
          </td>
        </tr>
      </ng-template>

    </p-table>
  </p-card>
}

<!-- Estado vacío (redundante pero visualmente consistent) -->
@if (!loading && !error && ordenes.length === 0) {
  <p-card header="Sin Órdenes" class="m-4 shadow-3 border-round-md text-center">
    <p class="text-gray-600">No hay órdenes disponibles</p>
  </p-card>
}
